{% extends 'base.html' %}

{% block content %}
<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="card border-0 shadow-sm mb-4">
                <div class="card-body p-5">
                    <h2 class="card-title mb-4">
                        <i class="fas fa-exclamation-triangle" style="color: #c9a961;"></i>
                        Cancel Order
                    </h2>
                    
                    <div class="alert alert-warning mb-4" role="alert">
                        <strong>Are you sure?</strong> Once cancelled, this order cannot be restored.
                    </div>
                    
                    <div class="order-details bg-light p-4 rounded mb-4">
                        <h5 class="mb-3">Order Details</h5>
                        <div class="row">
                            <div class="col-md-6">
                                <p><strong>Order Number:</strong> {{ order.order_number }}</p>
                                <p><strong>Status:</strong> <span class="badge bg-warning">{{ order.get_status_display }}</span></p>
                                <p><strong>Order Date:</strong> {{ order.created_at|date:"M d, Y" }}</p>
                            </div>
                            <div class="col-md-6">
                                <p><strong>Total Amount:</strong> ${{ order.total_price }}</p>
                                <p><strong>Items:</strong> {{ order.items.count }}</p>
                                <p><strong>Payment Method:</strong> {{ order.get_payment_method_display }}</p>
                            </div>
                        </div>
                        
                        <hr>
                        
                        <h6 class="mb-3">Items in this order:</h6>
                        <ul class="list-group list-group-flush">
                            {% for item in order.items.all %}
                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                <div>
                                    {% if item.product %}
                                        <strong>{{ item.product.name }}</strong><br>
                                        <small class="text-muted">Quantity: {{ item.quantity }}</small>
                                    {% else %}
                                        <strong>Product (Deleted)</strong>
                                    {% endif %}
                                </div>
                                <span class="badge bg-gold" style="background-color: #c9a961;">
                                    ${{ item.get_subtotal }}
                                </span>
                            </li>
                            {% endfor %}
                        </ul>
                    </div>
                    
                    <div class="alert alert-info mb-4" role="alert">
                        <strong>What happens after cancellation?</strong>
                        <ul class="mb-0 mt-2">
                            <li>Your order will be marked as cancelled</li>
                            <li>Stock will be restored for all items</li>
                            <li>You'll receive a confirmation email</li>
                            <li>If already paid, please contact us for refund information</li>
                        </ul>
                    </div>
                    
                    <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                        <a href="{% url 'user_orders' %}" class="btn btn-outline-secondary btn-lg">
                            <i class="fas fa-arrow-left"></i> Keep Order
                        </a>
                        <form method="POST" style="display: inline;">
                            {% csrf_token %}
                            <button type="submit" class="btn btn-danger btn-lg" onclick="return confirm('Are you absolutely sure you want to cancel this order?')">
                                <i class="fas fa-times"></i> Confirm Cancellation
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .badge {
        font-size: 0.85rem;
        padding: 0.5rem 0.75rem;
    }
    
    .list-group-item {
        border-bottom: 1px solid rgba(0,0,0,.125);
    }
    
    .card {
        border-radius: 10px;
    }
    
    .order-details {
        border-left: 4px solid #c9a961;
    }
</style>
{% endblock %}
